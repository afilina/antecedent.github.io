<!DOCTYPE html>
<html>
<head>
    <title>Patchwork</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="alternate" href="../articles/atom.xml" type="application/atom+xml">
    <link rel="stylesheet" href="../style.css" type="text/css">
    <script type="text/javascript">
    
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-20483190-1']);
      _gaq.push(['_trackPageview']);
    
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>    
</head>
<body>
    <div id="main">
        <ul id="nav">
            <li><a href="..">Home</a></li>
            <li><a href=".">Docs</a></li>
            <li><a href="https://github.com/antecedent/patchwork">Source</a></li>
            <li><a href="https://github.com/antecedent/patchwork/archives/master">Download</a></li>
        </ul>         
        <h1><a href="..">Patchwork</a><img src="../bracket.png" alt="Logo"></h1>
        <h2 class="with-border">Getting Started</h2>  
        <a href="." class="forward">Documentation Index &raquo;</a>
        <h3>Requirements</h3>
        <p>Patchwork requires PHP <strong>5.3.0</strong> or higher to run. Furthermore, <strong>no opcode caches</strong> should be enabled when using Patchwork.</p>
        <h3>Importing Patchwork</h3>
        <p>This step seems quite straightforward, as all you have to do is include <kbd>Patchwork.php</kbd>:</p>
        <pre>
<span class="keyword">require</span> __DIR__ . <span class="string">"/patchwork/Patchwork.php"</span>;</pre>
        <p>However, the exact place from where Patchwork is included makes a great difference. The next section explains this in more detail, but the general rule is to include Patchwork as early as possible.</p>
        <h3>Your Code and the Preprocessor</h3>
        <p>In order to make any kind of redefinition possible, Patchwork employs code preprocessing, meaning that every <kbd>include</kbd>, <kbd>require</kbd> and <kbd>eval</kbd> statement that is issued after importing Patchwork makes the included code go through an additional preprocessing layer.</p>
        <p>This layer injects some code into the beginning of every function. The injected code is responsible for forwarding the call to the replacement function when the called function is redefined. In essence, this means that only those functions that reside in preprocessed files (or dynamically evaluated portions of code) are eligible for redefinition.</p>
        <p>This leads to the following conclusions:</p>
        <ul>
            <li><kbd>Patchwork.php</kbd> must be included earlier than all files that contain functions or methods which may need to be redefined.</li>
            <li>If the file from which <kbd>Patchwork.php</kbd> is included contains any functions or methods, Patchwork will not be able to redefine them.</li>
            <li>Patchwork should be avoided in production environments because of the call interception overhead.</li>
        </ul>
        <h3>Further Steps</h3>
        <p>After that, you may already start redefining functions:</p>
        <pre>
Patchwork<span class="noise">\</span>replace<span class="noise">(</span><span class="string">"Post::delete"</span>, <span class="keyword">function</span><span class="noise">()</span>
<span class="noise">{</span>
    <span class="keyword">die</span><span class="noise">(</span><span class="string">"Why would you want to do that?"</span><span class="noise">)</span>;
<span class="noise">})</span>;</pre>
        <p>The generic redefinition API is described <a href="public-api.html">here</a>. Or, if you are going to use Patchwork with PHPUnit, you may want to use the <a href="phpunit-integration.html">PHPUnit integration layer</a> instead.
        <h3 class="comments">Comments</h3>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = 'antecedentgithub';
            var disqus_identifier = '/patchwork/docs/getting-started.html';
            var disqus_url = 'http://antecedent.github.com/patchwork/docs/getting-started.html';
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>        
    </div>
</body>
</html>
